
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>RumbleSan Heavy Noise Industries</title>
  <meta name="author" content="guy">

  
  <meta name="description" content="I had a request from a friend of mine on Google+ the other night for an example patch that would randomise the elements in a list. I was thinking of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://rumblesan.com/blog/page/5/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="RumbleSan Heavy Noise Industries" type="application/atom+xml">
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
    });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-19842221-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">RumbleSan Heavy Noise Industries</a></h1>
  
    <h2>Noise with weight</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:rumblesan.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="http://patchwerk.rumblesan.com">PatchWerk</a></li>
  <li><a href="http://rumblesan.tumblr.com">Glitchr</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/07/patch-a-day-november-2011-day-7-list-processing-part-4/">Patch-a-Day November 2011 Day 7: List Processing (Part 4)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-07T21:38:05+00:00" pubdate data-updated="true">Nov 7<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/11/07/patch-a-day-november-2011-day-7-list-processing-part-4/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I had a request from a friend of mine on Google+ the other night for an example patch that would randomise the elements in a list. I was thinking of doing it after the Euclidean Rhythms were finished but I think it fits in well with the rest of the list processing so I decided to write it up this evening. That also gives me a bit more time to neaten up the rhythm generation patch which is nearing completion.</p>

<p>The problem with randomising a list in PD is still that we can’t really address specific elements of a list. We can however, split it at arbitrary points, pull out a single element and then rejoin the other sections. If the point at which the list gets split is randomised then we have an effective way of pulling random elements out. Have a look at the below patch to see how this works.</p>

<p><img src="/a/2011-11-07-patch-a-day-november-2011-day-7-list-processing-part-4/random-list-element.png" alt="Random list element chooser" /></p>

<p>Split the list into two sections at a random point, use another split to pull the first item off the beginning of the second list, then rejoin these two sections of list. This results in a list with one less item and the random item. The randomisation is based off the length of the input list so it will always be in the correct range. If it selects the highest value then the second list section will be 1 element in length and that single element will be popped by the second split. If it selects the lowest, then the first half of the list will be empty (just a bang remember) but it will join fine with the other half.</p>

<p>Now we can do this it’s just a matter of returning the smaller list back to the input and storing the randomly chosen item to be joined into a new list.</p>

<p><img src="/a/2011-11-07-patch-a-day-november-2011-day-7-list-processing-part-4/randomise-list.png" alt="Randomise list" /></p>

<p>Each of the randomly selected items is send to a section of objects that will recursively add them to the previous output values. This gets reset when a new list is entered to make sure there’s nothing stored between parsing lists.</p>

<p>The output of the join for the two other list sections is checked, if it’s a list it gets sent back to the start for more parsing. If the last element has been selected then this value will be a bang, at which point the joined elements are output and there is no more processing to do.</p>

<p>Hopefully that will prove useful, at least for my friend. Using the stuff in the previous articles it wouldn’t be difficult to change this to deal with other sized groups of items if you need it but I’ll leave that up to you. I’ve included a stand alone abstraction of this patch in <a href="https://github.com/rumblesan/PatchaDay-Nov-2011">the git repository</a> as well so you can just download it if you need it. It’s called <strong>ritem</strong>, rather unimaginatively.</p>

<p>If there are any more requests then just ask and I’ll have a go at getting them done.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/06/patch-a-day-november-2011-day-6-list-processing-part-3/">Patch-a-Day November 2011 Day 6: List Processing (Part 3)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-06T23:16:26+00:00" pubdate data-updated="true">Nov 6<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/11/06/patch-a-day-november-2011-day-6-list-processing-part-3/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>More list processing today I’m afraid. I’m still working out how to properly transfer the Euclidean Rhythm equation to vanilla PD and I’m getting closer, but I keep finding there’s different problems to do with list parsing to overcome, which is great as far as me having things to write about goes, but I’d quite like to get to the point where I can make some music soon.</p>

<p>Tonight’s post is a bit of a short one because I’m knackered after the weekend. The problem is that the we need to find out what the remainder of two lists will be when they’re interleaved. The interleaving patches created last night will deal with this gracefully, but when generating the rhythm patterns we don’t actually want this to happen. We need to pull the remainder off and then re-interleave this with the output.</p>

<p>To further complicate matters, the remainder is dependant on the size of the elements we are dealing with so our patch needs to take this into account. Lets start off with the simplest case first.</p>

<p><img src="/a/2011-11-06-patch-a-day-november-2011-day-6-list-processing-part-3/list-length-matching.png" alt="List length matching" /></p>

<p>The list length objects calculate the lengths for each list, the min object is used to find which of these is the smallest and then both lists are split by this value. On the list with the smallest length the middle outlet of the split object will send a bang, on the longer list we get the excess elements.</p>

<p>It’s still necessary to make this deal with lists where we have different element sizes and at the moment if the two lists are the same length then there won’t be anything output for the excess. Both of these need fixing and the following abstraction does just that.</p>

<p><img src="/a/2011-11-06-patch-a-day-november-2011-day-6-list-processing-part-3/list-length-matching-with-elements.png" alt="List length matching with elements" /></p>

<p>As soon as you start dealing with multi item elements, things get a bit trickier. It’s times like this I wish that PD had better data structures for doing this sort of thing. This works in much the same was as the first version, but I’ve split everything out to make it a bit neater.</p>

<p>Top left is all the input parsing and making sure the data gets sent through in the right order to stop there being timing issues.</p>

<p>The two sections on the right are where the number of elements in a list and the split values are calculated. This deals with lists that have incomplete elements, i.e. the list <strong>1 2 3 4 5</strong> with an element size of two should be three elements, <strong>(1 2), (3 4), (5)</strong>.</p>

<p>The number of elements in each list is calculated, these values are compared and the smallest chosen, this is then converted from an element number back into an item number for each list and then they’re split.</p>

<p>The bottom left just makes sure the output comes out correctly, with a bit of logic to deal with even lists and the possibility of two bangs from the list splits for excess values.</p>

<p>Come back tomorrow where I might actually be making some patterns… if I can wrestle the maths into place.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/06/patchwerk-radio-site-back-up-an-running/">PatchWerk Radio Site Back Up an Running</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-06T13:00:42+00:00" pubdate data-updated="true">Nov 6<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/11/06/patchwerk-radio-site-back-up-an-running/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So I finally just bit the bullet, admitted that I couldn’t build a site that didn’t look rubbish and went back to using wordpress. There’s still a few bits that I need to put on there but for the most part  the important info is there.</p>

<p>Go check it out <a href="http://radio.rumblesan.com">http://radio.rumblesan.com</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/05/patch-a-day-november-2011-day-5-list-processing-part-2/">Patch-a-Day November 2011 Day 5: List Processing (Part 2)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-05T17:57:06+00:00" pubdate data-updated="true">Nov 5<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/11/05/patch-a-day-november-2011-day-5-list-processing-part-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yesterdays post started with some basic list processing in pure data, the patches showed how you could serialise and interleave the lists but there were a few problems and also some missing functionality that we’re after. Specifically :-</p>

<ul>
  <li>
    <p>when we interleave lists, if one is shorter than the other then the extra elements are still appended</p>

    <ul>
      <li><strong>a b c</strong> and <strong>1 2 3 4</strong> would become <strong>a 1 b 2 c 3 4</strong></li>
    </ul>
  </li>
  <li>
    <p>we can have larger sub elements</p>

    <ul>
      <li><strong>a b c d e f</strong> with <strong>1 2 3</strong> could become <strong>a b 1 c d 2 e f 3</strong></li>
    </ul>
  </li>
</ul>

<p>Both of these problems can be easily solved by checking for the output of the list split objects right hand outlet. This will only output anything when the input list is shorter than the number of elements we want to be splitting. So for example, if we have list split 2 and we send in a single item list, that single item will be output from the right outlet. Importantly, if we’re splitting single elements off the list and we send in an empty list (same as a bang remember) then we get a bang from this output. This is a much neater way to check when all our elements have been split out. The below patches shows how this works and how we can extend it to easily deal with multi item elements in the list.</p>

<p><img src="/a/2011-11-05-patch-a-day-november-2011-day-5-list-processing-part-2/better-list-serialising.png" alt="Better list serialising" /></p>

<p>Look at the left hand section where we check the outlet, bang the done output and then send the value to the main output unless it’s a bang. Importantly here, if we were dividing the list up into 2 item elements and we had an odd number of elements, the final element would be output from this right outlet. We still want that appended onto the end of our data, but we also still need to trigger that we’re done. The easiest way to do this is to say we’re done as soon as we have output from this outlet and just to send any values that aren’t bangs onwards.</p>

<p>On the right hand side the trigger for the recursion has moved down to after the bang routing and we’re also resetting the temporary list store. This is essentially to stop us from running into some tricky timing situations. I advise playing about with this code and seeing what happens if you switch around the order in which the right outlets value gets sent to the output and the resetting of that temp list store. This section can easily deal with any size of elements and any size list input. For a very small selection of objects it’s deceptively tricky.</p>

<p>So now we have that sorted, lets get back to our more complex list interleaving.</p>

<p><img src="/a/2011-11-05-patch-a-day-november-2011-day-5-list-processing-part-2/element-interleaving.png" alt="Element interleaving" /></p>

<p>This looks much the same as the last interleaving patch, the difference here is how it checks when it’s done. The two sections that send out the list elements can now deal with arbitrary sized elements and when they’ve sent out all their elements they will just keep sending out bangs. The section at the bottom that joins the two lists is now responsible for sending the done message and it does this when the output of the list append is a bang. The thing to remember again is that a bang is like an empty list so, if one of the element splitters runs out and starts sending bangs, but the other is still sending elements, then the output of the list append will still be a list item. As soon as both have finished, the output from the append will be a bang and we trigger that we’re done. This means that if we gave it <strong>1 2 3 4 5 6 7 8 9</strong> and <strong>a b c d e f g h</strong>, specifying 2 items to an element for the first list and 3 to an element for the second, we get <strong>1 2 a b c 3 4 d e f 5 6 g h 7 8 9</strong>, exactly what we want!</p>

<p>We now have a patch that can interleave two lists and deal with differently sized elements and different length lists. This is is one of the things at which I personally feel Pure Data isn’t that great, any other language this would be a few lines of code, but here it’s become something of a major effort and there are all sorts of timing issues to contend with. It’s one of the trade offs we make for using a graphical patching language  unfortunately, but once you understand it, it’s not as daunting as it first seems.</p>

<p>It may also seem confusing at this point why I’m actually building these list manipulation patches, if you read the links in the last post it should hopefully be clear, but if not I’‘ll hopefully answer all your questions tomorrow night. Come back then for some answer.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/04/patch-a-day-november-2011-day-4-list-processing/">Patch-a-Day November 2011 Day 4: List Processing</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-04T22:47:13+00:00" pubdate data-updated="true">Nov 4<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/11/04/patch-a-day-november-2011-day-4-list-processing/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This title may sound a bit dull but I’ve got some good intentions in mind so keep reading.</p>

<p>Yesterday I started reading up on how Euclidean Rhythms are created, I won’t go into too much detail here yet as there are a few stepping stones first but for those who want to jump straight to it there’s <a href="http://cgm.cs.mcgill.ca/~godfried/publications/banff.pdf">this paper by Godfried Toussaint</a> and then a <a href="http://ruinwesen.com/blog?id=216">blog post from Ruin and Wesen</a> which give most of the information you need. I had a look around to see if somebody had done this with Pure Data but it seemed most people had used or created externals. Whilst I’m not against using externals to do things, I wanted to try and make a Euclidean Rhythm generator in vanilla PD, because I’m a glutton for punishment pretty much.</p>

<p>A bit of research later and it’s clear that this is going to need some interesting list manipulation to get the results we’re after. Essentially the process involves interleaving the elements of a list in a fashion that’s actually a bit tricky to do with PD because of it’s non dynamic nature.</p>

<p>For this reason, this post and probably tomorrows will be all about list processing in PD. I’ve actually been learning quite a few things that in retrospect I’d consider to be the basics so I think it bears pointing them out as well for those that might not be so comfortable with PD’s lists.</p>

<p>A couple quick things,</p>

<ul>
  <li>
    <p>a list is a collection of data elements that has a <strong>list</strong> element at the front</p>

    <ul>
      <li>
        <p><strong>list 1 2 c d 5</strong></p>
      </li>
      <li>
        <p><strong>list a b c</strong></p>
      </li>
      <li>
        <p><strong>list 1.1 4 c</strong></p>
      </li>
    </ul>
  </li>
  <li>
    <p>if a list starts with a float or int then it doesn’t have to have “list” at the front</p>

    <ul>
      <li>
        <p><strong>1.1 2.2 3.3</strong> is the same as <strong>list 1.1 2.2 3.3</strong></p>
      </li>
      <li>
        <p><strong>a b c</strong> is not the same as <strong>list a b c</strong></p>
      </li>
      <li>
        <p>**a b c **is undefined. some objects will treat it as a list, some won’t</p>
      </li>
    </ul>
  </li>
  <li>
    <p>a bang is the same as an empty list</p>
  </li>
</ul>

<p>With these things in mind, lets have a look at the first patch that just simply takes a single list and serialises it into separate elements.</p>

<p><img src="/a/2011-11-04-patch-a-day-november-2011-day-4-list-processing/list-serialise.png" alt="List serialiser" /></p>

<p>The output from this would look like :-</p>

<blockquote>

  <pre><code>main: 1
main: 2
main: 3
main: 4
</code></pre>

</blockquote>

<p>Nothing spectacular but what we’re doing here is pretty important for the rest of this. The list split object here is used to pull off the first element of the list we feed in. This value comes out the left hand outlet, the rest of the list comes out the middle outlet and is stored in the second list object. When the first element is printed out it sends the rest of the list back into the split and in this manner we recursively pull the next element off the list, eventually printing them all out one by one.</p>

<p>Scaling this idea up a little it can be used to interleave two lists together. By that I mean that we can join two lists so that they are merged into one another, with the single elements from each list following the other. Probably best to explain with an example, if we have <strong>1 2 3 4 5</strong> and <strong>a b c d e</strong> then after the process we would have <strong>1 a 2 b 3 c 4 d 5 e</strong>. That’s exactly what the next patch does.</p>

<p><img src="/a/2011-11-04-patch-a-day-november-2011-day-4-list-processing/list-interlever1.png" alt="List interleaver patch" /></p>

<p>This patch talks about main list and sub list. To follow on from the above example, main list is <strong>1 2 3 4 5</strong> and sub list is <strong>a b c d e</strong>. The top left is just a bit of logic to make sure the sub list is in place before the main list starts the process running. The two groups of objects in the top centre are the list split feedback loops that serialise a list. These are setup so that a bang message can be sent to the get-next receive objects to get the next element. Also there’s a route bang and a send $0-done. When there are no more elements in the main list we assume that everything is finished and the lists are interleaved.</p>

<p>The section in the middle at the bottom joins the main and sub list items into one list, sends that to the final joining section, and then sends the bangs to get the next two items. The section on the right gets the join item pairs, recursively joins them to make one list and then when it recieves the done signal it outputs it.</p>

<p>There are a couple of problems with this patch thought, that I’ll fix tomorrow night but explain now in case someone wants to try and solve them themselves.</p>

<ul>
  <li>
    <p>if the main list is shorter than the sub list then elements get missed off</p>
  </li>
  <li>
    <p>if the sub list is shorter than the main list then the last sub list element is repeated</p>
  </li>
  <li>
    <p>we can only join single elements, not pairs or other numbers</p>
  </li>
</ul>

<p>I still haven’t quite worked out if I will be able to generate Euclidean Rhythms with these objects so if it turns out I can’t then these will just be a series of articles on list processing in Pure Data (still useful in places, but maybe not so much fun). I’m hoping though that I can get it all sorted and start making some excellent generative drums. Time will tell I suppose.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/03/patch-a-day-november-2011-day-3-passthrough-design-pattern-part-3/">Patch-a-Day November 2011 Day 3: Passthrough Design Pattern (Part 3)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-03T21:49:17+00:00" pubdate data-updated="true">Nov 3<span>rd</span>, 2011</time>
        
         | <a href="/blog/2011/11/03/patch-a-day-november-2011-day-3-passthrough-design-pattern-part-3/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Onto day three, and the last day of talking about design patterns for the moment. I’m going to finish off the synth voice bank patch from yesterday by neatening it up, minimising how much code we actually have and also by making the controls a bit more interactive.</p>

<p>By interactive, what I mean here is that when we switch between different voices, the values that the controls display will change to reflect the current settings of that voice. Without this it can become a bit tricky to make changes and will result in value jumps when a control starts from a different value to the one currently in use.</p>

<p>To do this I’ll first modify the param abstraction that’s used within the synth voice. It needs to be able to return the value for that parameter when we want it, which in this situation will be when it receives a “dump” message. You can think of it a bit like getters and setters in a class object. Have a look below.</p>

<p><img src="/a/2011-11-03-patch-a-day-november-2011-day-3-passthrough-design-pattern-part-3/synth-voice-control-params.png" alt="Synth voice with getters and setters" /></p>

<p>So there’s a couple more send objects around the part of our code that does the limit/scaling logic and the param abstraction has the storage and dump objects. When a dump message gets sent to the voice it will dump out the right hand inlet the value for each parameter, prefixed by its name.</p>

<p>Now that all of this is getting sent back to the main patch, to get it changing the control values it’s just a matter of reusing our param abstraction and putting in some send objects.</p>

<p><img src="/a/2011-11-03-patch-a-day-november-2011-day-3-passthrough-design-pattern-part-3/control-feedback.png" alt="Control parameter feedback" /></p>

<p>Nothing to it!</p>

<p>The next extension for this is to make a neater abstraction for the controls. Alas I’m running out of time for this evening so I’m just going to point you towards the <a href="https://github.com/rumblesan/PatchaDay-Nov-2011/tree/master/Day-3_Passthrough-improved_controls">git repository</a> where you can download it and have a look.</p>

<p>tata for now</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/02/patch-a-day-november-2011-day-2-passthrough-design-pattern-part-2/">Patch-a-Day November 2011 Day 2: Passthrough Design Pattern (Part 2)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-02T20:24:47+00:00" pubdate data-updated="true">Nov 2<span>nd</span>, 2011</time>
        
         | <a href="/blog/2011/11/02/patch-a-day-november-2011-day-2-passthrough-design-pattern-part-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>On to Day 2! Carrying on from where I left off yesterday I’ve got two example patches that should give you a good idea of how you can use the passthrough pattern in real situations and how you can extend the idea.</p>

<p>In the last post I mentioned that it can be useful when dealing with controllable parameters within a patch. We want to separate the part of the patch that deals with parsing the input control data, and the part of the patch that actually does the processing.</p>

<p>First up, have a look at this abstraction for a delay effect.</p>

<p><img src="/a/2011-11-02-patch-a-day-november-2011-day-2-passthrough-design-pattern-part-2/passthrough-delay-example.png" alt="Passthrough delay effect example" /></p>

<p>The section in the top centre with the border is the internal of the param abstraction, to the left of them there’s the daisy-chained group of them that will parse the mix, time, and feedback parameters. You’ll also see that there’s a route object routing for delay. If we had a number of effects patches daisy-chained then we’d want to be able to specify parameters in this object and this allows us to do it.</p>

<p>Below that we’ve got the part of the abstraction that deals with limiting our values between our chosen max and min and also use the line~ object to convert them to audio rate messages. The mix parameter we’re actually converting into two separate audio rate signals, one that controls the dry audio volume and the other to control the wet audio volume. These will crossfade between the two giving us good control.</p>

<p>Finally the section on the right is the delay effect itself. It’s actually pretty minimal and this is helped by having separated out all the control signal parsing and creation. Instead there are just a handful of send~ objects which makes more much neater code.</p>

<p>It’ worth noting that this patch itself adheres to the passthrough design. There is a data bus for all the control data, with anything not routed to the delay being passed onto the next object in the chain, and the audio itself passing through as well. it would be very easy to chain a number of these together and control them with not much effort, which is of course the idea here.</p>

<p>For a more useful example of that, this next patch has a bank of synth voices which can be independently or collectively controlled and use a poly object to share the incoming notes between them. It’s a bit scrappy but should illustrate the point well.</p>

<p><img src="/a/2011-11-02-patch-a-day-november-2011-day-2-passthrough-design-pattern-part-2/passthrough-synth-bank.png" alt="Passthrough synth bank example" /></p>

<p>The top right has the numboxes that set the values for our four controls as well as the ability to send notes to the voices. All the lists sent out through here get prefixed with the synth voice name. The small section to the left of this with the vertical radio bar is the voice chooser. We can choose a specific voice to send control messages to or we can use “all” to collectively change a single parameter on all the voices at the same time.</p>

<p>The far left group of objects uses a poly object to spread any incoming notes amongst the four voices. There are extra objects here that are pretty much just to deal with how poly works, it might be better to use a counter here but it servers well for illustrative purposes and is probably more flexible if you want to do more complex stuff.</p>

<p>Below all of this is the bank of voices and it should be easy to see here how this design pattern results in a lot of flexibility whilst having very neat code.</p>

<p>Here’s the insides of the voice abstraction. It’s a pretty basic FM synth that should be familiar to anybody who has looked at many of the patches I’ve made.</p>

<p><img src="/a/2011-11-02-patch-a-day-november-2011-day-2-passthrough-design-pattern-part-2/passthrough-synth-bank-voice.png" alt="Synth bank voice abstraction" /></p>

<p>Like the delay abstraction the message parsing, control value scaling and DSP sections are split apart. The route object that checks for the synth voice also checks for an “all” element at the start of the list which is how we can modify the parameters for all the voices together.</p>

<p>These two patches should have given you a good indication of how the passthrough design can be used to make concise, neat and logical patches that make problems like dealing with control messages or voice sharing easier.</p>

<p>Here it’s been used for both the control parameter parsing and organising the voices. Tomorrows post is going to neaten this synth bank patch up a lot and also show how continued use of the passthrough design can make it easier to make an interactive control interface where the values displayed will change to reflect the voice chosen.</p>

<p>Also I’ll point out that all the patches for this Patch-a-Day month will again be going into a Github repository. You can find it all at <a href="https://github.com/rumblesan/PatchaDay-Nov-2011">https://github.com/rumblesan/PatchaDay-Nov-2011</a></p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/01/patch-a-day-november-2011-day-1-passthrough-design-pattern-part-1/">Patch-a-Day November 2011 Day 1: Passthrough Design Pattern (Part 1)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-01T19:55:00+00:00" pubdate data-updated="true">Nov 1<span>st</span>, 2011</time>
        
         | <a href="/blog/2011/11/01/patch-a-day-november-2011-day-1-passthrough-design-pattern-part-1/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’m planning to spend the first few days of this week going over a design pattern I’ve found myself using in various ways. For anybody who is unsure what a Design Pattern might be I’d recommend checking the <a href="http://en.wikipedia.org/wiki/Design_pattern">Wikipedia Page</a> which gives a pretty reasonable answer. For those who don’t want to make the jump, the first sentence sums it up pretty well.</p>

<blockquote>
  <p>A design pattern in architecture and computer science is a formal way of documenting a solution to a design problem in a particular field of expertise.</p>
</blockquote>

<p>So what I’m going to be explaining here is just a simple idea you can use in your pure data patches that can help solve a variety of problems. One of the major problems (at least in my opinion) with patching languages like PD is that things can get pretty cluttered and hard to follow. This may be how you like to work and it’s certainly not a bad thing but I prefer to try to keep things neat and to compartmentalize sections of a patch in a logical fashion.</p>

<p>At this point I want to mention this article from <a href="http://www.creativeapplications.net/theory/patch-schematics-%E2%80%93-the-aesthetics-of-constraint-best-practices-theory/">Creative Applications</a> which talks a lot about this and covers a bit of the same ground. I’m planning to go more in-depth but this is a really good article for getting your head around some of this.</p>

<p>Anyway, onto the first example. The design pattern I want to talk about is one that I call the Passthrough. The above article mentions daisy chaining patches together vertically, so the data output of one flows into the next and the passthrough is sort of a logical extension of this.</p>

<p>Each patch has a control bus and a data bus:-</p>

<ul>
  <li>
    <p>Control messages flow through the patches and are routed into the correct patches using a route object with abstraction arguments.</p>
  </li>
  <li>
    <p>Data output from a patch will flow into the main data bus and the messages will all be output from the outlet of the last patch</p>
  </li>
</ul>

<p>A Diagram will make this a bit easier to understand.</p>

<p><a href="/a/2011-11-01-patch-a-day-2011-day-1-passthrough-design-pattern-part-1/passthrough-basic.png"><img src="/a/2011-11-01-patch-a-day-2011-day-1-passthrough-design-pattern-part-1/passthrough-basic.png" alt="basic passthrough design" /></a>
    Basic Passthrough example</p>

<p>The section on the left, surrounded by the black border, is the internals of the passthrough-abs abstraction. The right inlet/outlet is the control bus and the left inlet/outlet the data bus. Each abstraction has two arguments, one sets what the route object is looking for, the other is its output value. When a number is sent into the right inlet it will be sent to the route object in all of the abstractions. If the number sent matches the route argument then a bang will be sent out its inlet. This will cause the value in the symbol object to be sent out the data bus outlet. This data will pass through all the abstractions below the one triggered, but it will not affect them, eventually going to the list trim (to remove the symbol element at the front of the message) and then get printed.</p>

<p>If we send in multiple numbers then all the relevant abstractions will be triggered but the data will still only come out one outlet. This sort of pattern can help simplify the data routing of a patch. A simple extension to this is to add an “all” option that will output the value of every abstraction.</p>

<p><a href="/a/2011-11-01-patch-a-day-2011-day-1-passthrough-design-pattern-part-1/passthrough-all.png"><img src="/a/2011-11-01-patch-a-day-2011-day-1-passthrough-design-pattern-part-1/passthrough-all.png" alt="basic passthrough with all option" /></a>
    Basic Passthrough with all option</p>

<p>This idea can be made more useful when combined with send objects as a good way of getting control data to where it’s needed in a patch without having lots of patch chords all over the place. This is something I’ve seen used in the <a href="http://puredata.hurleur.com/sujet-1531-sssad-save-module">SSSAD patch save module</a> and also the <a href="https://github.com/rjdj/rjlib">rjlib libraries</a> and is originally what made me start thinking about this pattern.</p>

<p><img src="/a/2011-11-01-patch-a-day-2011-day-1-passthrough-design-pattern-part-1/passthrough-send.png" alt="Passthrough with sends" /></p>

<p>In this case, the s-passthrough-abs only has the control bus with the data bus having been replaced by a send object. The value that we are routing for is in this case being used both in the route object and the send object and we are also passing in the main patches $0 value as an argument. The $0 value is prefixed onto the send name so that it stays within the scope of just this patch. When a list in the form of “name value” is sent down the control bus it will be routed by the correct abstraction and the value will be sent to the corresponding receive object.</p>

<p>This may seem a little confusing to begin with, but imagine if this patch was part of a delay effect, and that instead of the names one, two, three and four, we instead had delay, feedback, mix and pan. We could use the abstractions to parse the input control messages and then send the values to the correct place in our patch. The section of the code dealing with the audio processing could be kept separate from this and would just need receive objects in the correct places. This would result in much neater and more logically structured code.</p>

<p>So I’m going to leave it there for tonight. I’m planning on spending the next two nights going into this in greater detail and with some more “real world” examples of how this can be pretty useful. After that I intend to get back into the algorithmic stuff so come back then if that’s what you’re after.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/01/patch-a-day-month-2-november-2011/">Patch-a-Day Month 2, November 2011</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-01T18:57:34+00:00" pubdate data-updated="true">Nov 1<span>st</span>, 2011</time>
        
         | <a href="/blog/2011/11/01/patch-a-day-month-2-november-2011/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So it’s now a year since the last patch-a-day month and I think it’s necessary to do this again. I’ve got some ideas for a few things I really want to do and this would be a good way of just getting them done. As well as that, I realise that I need to write more patches for PatchWerk Radio. I’m still fixing up bits on the back-end but the actual patches haven’t changed for a bit, probably because it seems like I haven’t been doing anything with it.</p>

<p>Anyway, I’m going to get a smallish patch sorted for tonight, I’m planning on spending this week going over some of the design patterns I’ve started using in Pure Data. Might not be the most interesting stuff but it’s all useful. If you’re really after cool, algorithmic patches then don’t worry, there’ll still be plenty of those.</p>

<p>Right, nose to the grind stone, lets get this party started!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/25/the-co-ordinate-diff-sequencer-for-pdrene/">The Co-ordinate Diff Sequencer for PDRene</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-25T20:15:58+01:00" pubdate data-updated="true">Oct 25<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/25/the-co-ordinate-diff-sequencer-for-pdrene/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So in the previous post I mentioned I’d do a more in depth look at what’s going on inside the Diff Sequencer I’ve created. For a bit of a recap, <a href="http://www.rumblesan.com/?p=302">check out what I said there</a>.</p>

<p>So the Diff Sequencer is basically a way of sequencing pairs of numbers that are used to modify the X/Y coordinates of the current position on the grid. There are up to four pairs in a sequence and the sequencer will loop through these. Furthermore, each pair has a step value which is how many clock pulses that pair will be output for.</p>

<p>Lets jump straight to the internals to pick it all apart.</p>

<p><img src="/a/2011-10-25-the-co-ordinate-diff-sequencer-for-pdrene/pdrene_diff_sequencer1.png" alt="Diff Sequencer internals" /></p>

<p>Most of the work is done by the pair of counters in the top left. The upper one counts up to the step number for the current pair and when it overflows it triggers the next counter to move along one more value in the sequence. The groups of objects in the top right are for externally changing the sequencers settings.</p>

<p>The interface between the UI and the counters is done using semi-colon sends from message boxes. The pair-value numboxes all have receive names in the format $0-#-x-set and $0-#-y-set where # is the pair number from 0 to 3. They all send to the $0-x-out and $0-y-out receives. When the counters move onto</p>

<p>The values are output each clock cycle and the whole thing will just keep going round. Settings, lengths etc can be modified as it runs.</p>

<p>Pretty simple really.</p>

<p>EDIT: only noticed last night that the image was extending out of the central div!! fixed now, but I should pay more attention</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/6/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/4/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/09/11/cuttr-is-now-live-and-running/">Cuttr is now live and running</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/30/programming-is-good-for-the-soul/">Programming is good for the soul</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/08/organising-domains-and-migrating-sites/">Organising Domains and migrating sites</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/30/glitchr-up-and-running/">Glitchr up and running</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/24/octopress-customisation/">Octopress Customisation</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/rumblesan">@rumblesan</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'rumblesan',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("rumblesan", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/rumblesan" class="twitter-follow-button" data-show-count="false">Follow @rumblesan</a>
  
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - guy -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'rumblesan';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
