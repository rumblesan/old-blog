
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Patch-a-Day Month Day 27: FFT based Pitch Shift and Time Freeze - RumbleSan Heavy Noise Industries</title>
  <meta name="author" content="guy">

  
  <meta name="description" content="Following on from yesterdays two useful FFT based patches, I have another two for you today. The first is actually really simple but quite useful, an &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://rumblesan.com/blog/2010/11/27/patch-a-day-month-day-27-fft-based-pitch-shift-and-time-freeze/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="RumbleSan Heavy Noise Industries" type="application/atom+xml">
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
    });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-19842221-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">RumbleSan Heavy Noise Industries</a></h1>
  
    <h2>Noise with weight</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:rumblesan.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="http://patchwerk.rumblesan.com">PatchWerk</a></li>
  <li><a href="http://rumblesan.tumblr.com">Glitchr</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Patch-a-Day Month Day 27: FFT Based Pitch Shift and Time Freeze</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-11-27T18:22:23+00:00" pubdate data-updated="true">Nov 27<span>th</span>, 2010</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Following on from yesterdays two useful FFT based patches, I have another two for you today. The first is actually really simple but quite useful, an pitch shifter that will shift sounds you send through it up. It’s definitely not clean or accurate but it could well make for some cool patches when combined with other things.</p>

<p>The second is a time freezer patch. This has quite a bit in common with the granular synth stuff from before but this time we’re replaying a block of FFT data. It’s possibly more interesting just to see the implementation, which is by no means necessarily the right way to do this, but it works pretty well.</p>

<p><img src="/a/2010-11-27-patch-a-day-month-day-27-fft-based-pitch-shift-and-time-freeze/27-FFTDirtyShift.png" alt="A basic pitch shifter based on FFT" /></p>

<p>The main patch of the pitch shifter is really very basic. The only change is that we have a number box getting 128 added to it, going through an int to make sure it’s a whole number and then being passed to a shift object. This patch works by using a very short delay to shift the frequency bins along so that lower bins take the place of higher bins. The +128 is there because the effect doesn’t start happening untill the delay is a minimum of 128 samples. I think this might be to do with the minimum delay allowed by delay objects in PD but I’m really not sure.</p>

<p><img src="/a/2010-11-27-patch-a-day-month-day-27-fft-based-pitch-shift-and-time-freeze/27-FFTDirtyShiftSubPatch.png" alt="FFT based pitch shifter internals" /></p>

<p>Really all that is happening here is that the FFT data is delayed going into the inverse FFT object. By delaying by values that are less than a blocksize length we get a shifting up effect.</p>

<p>The time freeze has much more going on with it. What we need to do is store a block of FFT data and continuously replay this back through the inverse fft object. I chose to do this using a tabwrite~ that records the sample block when the freeze is turned on and then switches the input to the inverse fft to be a pair of tabreceive~ objects.</p>

<p><img src="/a/2010-11-27-patch-a-day-month-day-27-fft-based-pitch-shift-and-time-freeze/27-FFTTimeFreezeSubPatch.png" alt="FFT based Time Freeze sub patch" /></p>

<p>When the freeze is turned on the sel 1 will bang the tabwrites to record the FFT block. The second toggle chooses between the normal signal or the tabreceives. pretty simple but quite effective.</p>

<p><img src="/a/2010-11-27-patch-a-day-month-day-27-fft-based-pitch-shift-and-time-freeze/27-FFTTimeFreeze.png" alt="FFT based Time Freeze" /></p>

<p>The main patch is just using a variable delay to turn the freeze on a bit after the FM synth triggers are clicked. Click them once to play the first half of the FM tone and then again to stop the freeze and get the tail run off. On it’s own this isn’t so great but it’s a basic building block of lots of interesting stuff. I plan to implement some stuff like this in the Granular Synth once I get a chance.</p>

<p>Anyway, the patches can be downloaded here for people that want them.</p>

<p><a href="/a/2010-11-27-patch-a-day-month-day-27-fft-based-pitch-shift-and-time-freeze/27-FFTPitchShiftandFreeze.zip">FFT based pitch shift and time freeze</a></p>

<p>I think for the last three days of Patch-a-day I’m just going to do some basic tutorials on Pure Data specifics. For example, how to use abstractions effectively, and some of the useful GUI stuff that it does. Depends a bit on how much time I have tomorrow I think.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">guy</span></span>

      








  


<time datetime="2010-11-27T18:22:23+00:00" pubdate data-updated="true">Nov 27<span>th</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/music/'>Music</a>, <a class='category' href='/blog/categories/patch-a-day/'>Patch-A-Day</a>, <a class='category' href='/blog/categories/pure-data/'>Pure Data</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2010/11/27/patch-a-day-month-day-26-fast-fourier-transform-finished/" title="Previous Post: Patch-a-Day Month Day 26: FFT based EQ and Delay">&laquo; Patch-a-Day Month Day 26: FFT based EQ and Delay</a>
      
      
        <a class="basic-alignment right" href="/blog/2010/11/28/patch-a-day-month-day-28-simple-but-useful/" title="Next Post: Patch-a-Day Month Day 28: Simple But Useful">Patch-a-Day Month Day 28: Simple But Useful &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/09/11/cuttr-is-now-live-and-running/">Cuttr is now live and running</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/30/programming-is-good-for-the-soul/">Programming is good for the soul</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/08/organising-domains-and-migrating-sites/">Organising Domains and migrating sites</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/30/glitchr-up-and-running/">Glitchr up and running</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/24/octopress-customisation/">Octopress Customisation</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/rumblesan">@rumblesan</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'rumblesan',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("rumblesan", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/rumblesan" class="twitter-follow-button" data-show-count="false">Follow @rumblesan</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - guy -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'rumblesan';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://rumblesan.com/blog/2010/11/27/patch-a-day-month-day-27-fft-based-pitch-shift-and-time-freeze/';
        var disqus_url = 'http://rumblesan.com/blog/2010/11/27/patch-a-day-month-day-27-fft-based-pitch-shift-and-time-freeze/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
